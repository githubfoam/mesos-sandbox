---
sudo: required
notifications:
  slack:
    on_failure: always

matrix:
  fast_finish: true
  include:

    # - name: "deploy vagrant chef provisioning - focal"
    #   dist: focal
    #   language: python
    #   # python: 3.7
    #   before_install:
    #     - pip3 install virtualenv
    #     - virtualenv -p $(which python3) ~venvpy3
    #     - source ~venvpy3/bin/activate
    #     - pip install -r requirements.txt
    #   script:
    #     - sudo make deploy-libvirt
    #     - sudo make deploy-vagrant
    #     - sudo make deploy-chef
    #   after_success:
    #     - deactivate  

    - name: "deploy vagrant puppet provisioning - focal"
      dist: focal
      language: python
      # python: 3.7
      before_install:
        - pip3 install virtualenv
        - virtualenv -p $(which python3) ~venvpy3
        - source ~venvpy3/bin/activate
        - pip install -r requirements.txt
      script:
        # - sudo make deploy-libvirt
        # - sudo make deploy-vagrant
        - echo "Downloading DC/OS installer"
        - sudo mkdir -v dcos
        - sudo wget -O dcos/dcos_generate_config.sh -c https://downloads.dcos.io/dcos/stable/dcos_generate_config.sh
        # - sudo mkdir -v vagrant/var-cache-apt-archives
        # - sudo dcos dcos/dcos_generate_config.sh vagrant/var-cache-apt-archives
        # - sudo make deploy-puppet
      after_success:
        - deactivate 

    - name: "deploy vagrant puppet provisioning - bionic"
      dist: bionic
      language: python
      # python: 3.7
      before_install:
        - pip3 install virtualenv
        - virtualenv -p $(which python3) ~venvpy3
        - source ~venvpy3/bin/activate
        - pip install -r requirements.txt
      script:
        # - sudo make deploy-libvirt
        # - sudo make deploy-vagrant
        - echo "Downloading DC/OS installer"
        - sudo mkdir -v dcos
        - sudo wget -O dcos/dcos_generate_config.sh -c https://downloads.dcos.io/dcos/stable/dcos_generate_config.sh
        - sudo mkdir -vp vagrant/var-cache-apt-archives
        - sudo dcos dcos/dcos_generate_config.sh vagrant/var-cache-apt-archives
        # - sudo make deploy-puppet
      after_success:
        - deactivate        